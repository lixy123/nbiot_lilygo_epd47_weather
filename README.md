# LilyGo-EPD47-HC08
LilyGo-EPD47 利用hc08蓝牙硬件实现平时休眠节能，随时按需唤醒显示文字的demo

<b>一.功能：</b><br/>
1.记事留言提醒是人类的最基本需求，现今互联网，云服务时代，信息无处不在，但可惜，绝大部分信息都是对商家有用，个人无益的无用信息，并不是 专为个人准备的。信息需要有序，按需供应，该出现时就出现，不需要时就关闭。<br/>
2.lilygo-epd47结合了墨水屏和 ESP32的低功耗特点. 都具有休眠唤醒节能特性，适合省电场景下的记事留言。其它硬件方案无法提供此功能的关键点是供电，摆放位置周围必须有插座，限制了显示屏留言提醒的使用场景。虽然手机本身很容易做成提醒留言，但手机信息干扰太多,且打开手机APP会增加操作步骤,不太适合做提醒留言，因为增加了几步的点击和人的懒惰,减少了使用顺畅度。<br/>
3.hc08是一个低功耗的蓝牙设备，一级节能模式的待机电流约0.2-1ma,可以在几秒内通过蓝牙扫描到并连接及激活宿主机器。特别适合与以上设备协作工作。<br/>
4.所以,最终场景设计为 lilygo-epd47电池供电状态放置在桌子上,大门后,冰箱上做为能无线接收文字信息并显示提醒留言,天气等信息的智能显示屏，除了简单的天气预报,行事历同步,甚至可以结合树莓派拖管微信,MQTT服务端转发来发送更高级的文字信息应用, 例如出门携带物品提醒，记事安排提醒等. <br/>
5.lilygo-epd47 墨水屏平时不工作时处于休眠状态，最大化省电,当需要显示信息时立即唤醒并显示文字,信息显示完再次进入休眠状态<br/>
  数据指标:<br/>
    5.1 休眠时整体电流<1ma <br/>
    5.2 唤醒时间<1秒 <br/>
    5.3 lilygo-epd47墨水屏每天唤醒并显示3次天气信息，平时偶尔有零星文字提醒记事显示， 普通的18650电池能支持墨水屏约1-3个月<br/>
6.关于唤醒硬件选择,尝试过lora, nb-iot, 其中nb-iot模块关闭节能约1ma, 相对hc08蓝牙闲时电流(时间均滩<0.3ma)显得过大,不适合直接连接到墨水屏,但可做到发送器上.<br/>

<b>二.硬件需求：</b><br/>
1.lilygo-epd47  带esp32主控芯片的墨水屏.  可电池供电, 附加HC08蓝牙设备后能随时接收文字信息并显示<br/>
     hc-08 BLE4.0蓝牙模块 (购买时要询问,告诉卖方要双晶振版本，否则不支持一级节能模式)<br/>
     hc-08设置成客户模式，一级节能模式,蓝牙名称最好用AT指令修改下,防止被别的设备误连，建议名称：edp47_ink<br/>
     lilygo 公司已开始出货 hc-08在lilygo-epd47 墨水屏上的专用集成模块成品,使用触摸屏长供电的vcc,数据引脚,集成度更好. <br/>
     <br/>
     注：官方数据，一级节能模式电流约 6μA ~2.6mA （待机） /1.6mA（工作）<br/>
        相对于全速模式 8.5mA（待机）/9mA（待机） 节能效果明显<br/>
        hc-08模块每日大部分时间应处于在 6μA ~2.6mA （待机）模式,理论电流消耗极低<br/>
     引脚连接:<br/>
     lilygo-epd47  hc-08<br/>
       VCC         VCC<br/>
       14          TX<br/>
       15          RX<br/>
       GND         GND<br/>
    注：墨水屏进入节能休眠模式后，墨水屏顶端VCC,14，15,GND 插槽处的VCC的3.3V电压输出会中断，不能在此插槽处取电，要从ph2.0或18650处取电<br/>   
    hc08 AT命令预处理:<br/>
    AT+MODE=1        //设置成一级节能模式(必须)<br/>
    AT+NAME=INK_047  //修改蓝牙名称，用于客户端查找蓝牙用<br/>
    AT+LED=0          //关闭led灯，省电<br/>
    注: 也可以通过连接到lilygo-epd47后,自编程序用lilygo-epd47虚拟串口传入AT命令
    
    
2.ESP32 信息发送器, 获取信息,通过蓝牙将信息推送给墨水屏显示<br/>
  2.1 ESP32开发板芯片(建议带psram) <br/>
  2.2 如果后期想搞语音转文字高级功能，需要ESP32带PSRAM的版本, 可考虑用 lilygo-t-watch系列, t-watch本质上是ESP32外加外设的集成产品。<br/>  


<b>三.代码说明:</b> <br/>

  <b>epd47_blue_waker_center_nb_iot 蓝牙主机-中心</b>    
    <img src= 'https://github.com/lixy123/LilyGo-EPD47-HC08/blob/main/sim7020-2.jpg?raw=true' /> <br/>
    <img src= 'https://github.com/lixy123/LilyGo-EPD47-HC08/blob/main/sim7020-1.jpg?raw=true' /> <br/>
      epd47_blue_waker_center_weather的 NB-IOT版本, 用nb-iot网代替wifi网<br/>
     <b> 4.1 硬件组成：</b><br/>
      A.ESP32开发板(建议带psram)<br/>
      B.DS3231时钟模块 <br/>
      C.Sim7020c模块 <br/>
      把NB-IOT当路由器使用，适合于仓库，家里或车上没有wifi网络，或公司里虽然有wifi,但各种上网验证，不适合单片机连接上网的场合。<br/>
     <b> 4.2 引脚连接:</b>  <br/>
  ESP32 Sim7020c <br/> 
  5V    5v <br/>
  GND   GND <br/>
  12    TX <br/>
  13    RX <br/>
  15    RESET  (注：仅用于sim7020复位，不用能用开，关sim7020) <br/>
  
  
  
<b>四.电流实测:</b><br/>
  1.休眠： <1ma （客户端蓝牙发完信息要断开，否则墨水屏的蓝牙模块不能进入休眠，电流约9ma)<br/>
  2.唤醒后: 50-60ma<br/>
  蓝牙模块官方数据提到待机电流约6μA ~2.6mA，墨水屏待机电流约0.17ma，合计电流约<0.4ma<br/>
  3.1200ma的电池约能用 1200*0.8/24/0.4=80天,满足预期<br/>
  

  
  
  
